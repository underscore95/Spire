#ifndef SPIRE_VOXEL_DATA_HASH_MAP
#define SPIRE_VOXEL_DATA_HASH_MAP

#include "ShaderInfo.h"

#ifdef __cplusplus
namespace SpireVoxel {
#endif

#define SPIRE_VOXEL_DATA_NUM_HASH_FUNCTIONS 10
#define SPIRE_VOXEL_DATA_EMPTY_VOXEL_TYPE 0

    // hash coefficients
#ifdef __cplusplus
    SPIRE_KEYWORD_STATIC constexpr std::array VOXEL_DATA_HASH_COEFFICIENTS = {
#else
    const SPIRE_UVEC3_TYPE VOXEL_DATA_HASH_COEFFICIENTS[SPIRE_VOXEL_DATA_NUM_HASH_FUNCTIONS] = HASH_COEFFICIENTS[SPIRE_VOXEL_DATA_NUM_HASH_FUNCTIONS](
#endif
        SPIRE_UVEC3_TYPE(1061060661, 855378910, 3502893387),
        SPIRE_UVEC3_TYPE(2383498209, 1644277160, 2749756682),
        SPIRE_UVEC3_TYPE(671433660, 814371953, 3950429538),
        SPIRE_UVEC3_TYPE(1934605449, 3143018405, 2436686234),
        SPIRE_UVEC3_TYPE(41216935, 2734168707, 2265436213),
        SPIRE_UVEC3_TYPE(2965107964, 3434689208, 2616134055),
        SPIRE_UVEC3_TYPE(816425089, 1132258741, 1382123267),
        SPIRE_UVEC3_TYPE(373591499, 1250552626, 497653521),
        SPIRE_UVEC3_TYPE(1892588271, 3869359181, 4038477593),
        SPIRE_UVEC3_TYPE(3867437441, 2157261722, 3688971228)

#ifdef __cplusplus
    };
#else
    );
#endif

    // hash function for voxel data
    // hashes key x y z into uint32
    SPIRE_KEYWORD_INLINE SPIRE_KEYWORD_NODISCARD SPIRE_UINT32_TYPE VoxelDataHashMapHash(
        SPIRE_UINT32_TYPE x, SPIRE_UINT32_TYPE y, SPIRE_UINT32_TYPE z,
        SPIRE_UINT32_TYPE hashFunction
    ) {
        return (x * VOXEL_DATA_HASH_COEFFICIENTS[hashFunction].x) ^
               (y * VOXEL_DATA_HASH_COEFFICIENTS[hashFunction].y) ^
               (z * VOXEL_DATA_HASH_COEFFICIENTS[hashFunction].z);
    }

#ifdef __cplusplus
}
#endif
#endif
